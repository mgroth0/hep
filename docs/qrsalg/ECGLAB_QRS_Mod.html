<!DOCTYPE html><html><head><link rel="stylesheet" href="style.css">
        
        <script>
        
        </script>
        
        </head><body><div><a href="https://u.nu/qy-4k">Original ECGLAB Paper</a><div class="highlight"><pre style="line-height: 125%"><span></span>    <span style="color: #6400EB; font-weight: bold">def</span> <span style="color: #FF5EB5">preprocess</span>(<span style="color: #DCDDFF">self</span>, <span style="color: #DCDDFF">ecg</span>, <span style="color: #DCDDFF">Fs</span>):
        <span style="color: #6400EB; font-weight: bold">with</span> <span style="color: #DCDDFF">plt</span>.<span style="color: #DCDDFF">style</span>.<span style="color: #DCDDFF">context</span>(<span style="color: #00FF00">&#39;dark_background&#39;</span>):
            <span style="color: #DCDDFF">plt</span>.<span style="color: #DCDDFF">plot</span>(<span style="color: #DCDDFF">ecg</span>)
            <span style="color: #DCDDFF">PROJ</span>.<span style="color: #DCDDFF">RESOURCES_FOLDER</span>.<span style="color: #DCDDFF">mkdirs</span>()[<span style="color: #00FF00">&#39;figs/qrsalg&#39;</span>].<span style="color: #DCDDFF">mkdirs</span>()
            <span style="color: #DCDDFF">im_file</span> = <span style="color: #DCDDFF">PROJ</span>.<span style="color: #DCDDFF">RESOURCES_FOLDER</span>[<span style="color: #00FF00">&#39;figs/qrsalg/ECGLAB_QRS_Mod1.png&#39;</span>]
            <span style="color: #DCDDFF">plt</span>.<span style="color: #DCDDFF">savefig</span>(<span style="color: #DCDDFF">im_file</span>.<span style="color: #DCDDFF">abspath</span>)
        <span style="color: #DCDDFF">DOC</span>.<span style="color: #DCDDFF">children</span> += [<span style="color: #DCDDFF">AutoHTMLImage</span>(<span style="color: #DCDDFF">im_file</span>)]
        <span style="color: #DCDDFF">DOC</span>.<span style="color: #DCDDFF">children</span> += [<span style="color: #DCDDFF">bib2html</span>(<span style="color: #DCDDFF">bib_data</span>)]
</pre></div>
################Bandpass Filter################<div class="highlight"><pre style="line-height: 125%"><span></span>        <span style="color: #DCDDFF">Q</span> = <span style="color: #00EBAA; font-style: italic">3</span>  <span style="color: #353535"># optimum ripple length for detection</span>
        <span style="color: #DCDDFF">k</span> = <span style="color: #00EBAA; font-style: italic">1.2</span>  <span style="color: #353535"># gain, does not effect detection</span>
</pre></div>
FixMe: * 2 * math.pi... why?<div class="highlight"><pre style="line-height: 125%"><span></span>        <span style="color: #DCDDFF">w0</span> = <span style="color: #00EBAA; font-style: italic">17</span> * <span style="color: #00EBAA; font-style: italic">2</span> * <span style="color: #DCDDFF">math</span>.<span style="color: #DCDDFF">pi</span>
        <span style="color: #DCDDFF">numerator</span> = <span style="color: #DCDDFF">k</span> * <span style="color: #DCDDFF">w0</span>**<span style="color: #00EBAA; font-style: italic">2</span>
        <span style="color: #DCDDFF">denominator</span> = [<span style="color: #00EBAA; font-style: italic">1</span>, (<span style="color: #DCDDFF">w0</span> / <span style="color: #DCDDFF">Q</span>), <span style="color: #DCDDFF">w0</span>**<span style="color: #00EBAA; font-style: italic">2</span>]
</pre></div>
matplotlib.rcParams['text.usetex'] = True<div class="highlight"><pre style="line-height: 125%"><span></span>        <span style="color: #DCDDFF">plt</span>.<span style="color: #DCDDFF">clf</span>()
        <span style="color: #6400EB; font-weight: bold">with</span> <span style="color: #DCDDFF">plt</span>.<span style="color: #DCDDFF">style</span>.<span style="color: #DCDDFF">context</span>(<span style="color: #00FF00">&#39;dark_background&#39;</span>):
            <span style="color: #DCDDFF">plt</span>.<span style="color: #DCDDFF">text</span>(
                <span style="color: #DCDDFF">x</span>=<span style="color: #00EBAA; font-style: italic">0.5</span>,
                <span style="color: #DCDDFF">y</span>=<span style="color: #00EBAA; font-style: italic">0.5</span>,
                <span style="color: #DCDDFF">s</span>=<span style="color: #00FF00">&#39;whatever&#39;</span>
</pre></div>
s='$\displaystyle\sum_{n=1}^\infty'r'\frac{-e^{i\pi}}{2^n}$'<div class="highlight"><pre style="line-height: 125%"><span></span>            )
            <span style="color: #DCDDFF">PROJ</span>.<span style="color: #DCDDFF">RESOURCES_FOLDER</span>.<span style="color: #DCDDFF">mkdirs</span>()[<span style="color: #00FF00">&#39;figs/qrsalg&#39;</span>].<span style="color: #DCDDFF">mkdirs</span>()
            <span style="color: #DCDDFF">im_file</span> = <span style="color: #DCDDFF">PROJ</span>.<span style="color: #DCDDFF">RESOURCES_FOLDER</span>[<span style="color: #00FF00">&#39;figs/qrsalg/ECGLAB_QRS_Mod2.png&#39;</span>]
            <span style="color: #DCDDFF">plt</span>.<span style="color: #DCDDFF">savefig</span>(<span style="color: #DCDDFF">im_file</span>.<span style="color: #DCDDFF">abspath</span>)
        <span style="color: #DCDDFF">DOC</span>.<span style="color: #DCDDFF">children</span> += [<span style="color: #DCDDFF">AutoHTMLImage</span>(<span style="color: #DCDDFF">im_file</span>)]
</pre></div>
matplotlib.rcParams['text.usetex'] = False<div class="highlight"><pre style="line-height: 125%"><span></span>        <span style="color: #DCDDFF">z</span>, <span style="color: #DCDDFF">p</span> = <span style="color: #DCDDFF">bilinear</span>(<span style="color: #DCDDFF">numerator</span>, <span style="color: #DCDDFF">denominator</span>, <span style="color: #DCDDFF">Fs</span>)
        <span style="color: #DCDDFF">ecg_flt</span> = <span style="color: #DCDDFF">filtfilt</span>(<span style="color: #DCDDFF">z</span>, <span style="color: #DCDDFF">p</span>, <span style="color: #DCDDFF">ecg</span>)
        <span style="color: #DCDDFF">ecg_flt</span> = <span style="color: #DCDDFF">lfilter</span>([<span style="color: #00EBAA; font-style: italic">1</span>, -<span style="color: #00EBAA; font-style: italic">1</span>], <span style="color: #00EBAA; font-style: italic">1</span>, <span style="color: #DCDDFF">ecg_flt</span>)
</pre></div>
low-pass 30 Hz<div class="highlight"><pre style="line-height: 125%"><span></span>        [<span style="color: #DCDDFF">z</span>, <span style="color: #DCDDFF">p</span>] = <span style="color: #DCDDFF">butter</span>(<span style="color: #00EBAA; font-style: italic">8</span>, <span style="color: #00EBAA; font-style: italic">30</span> / (<span style="color: #DCDDFF">Fs</span> / <span style="color: #00EBAA; font-style: italic">2</span>))
        <span style="color: #DCDDFF">ecg_flt</span> = <span style="color: #DCDDFF">lfilter</span>(<span style="color: #DCDDFF">z</span>, <span style="color: #DCDDFF">p</span>, <span style="color: #DCDDFF">ecg_flt</span>)
        <span style="color: #DCDDFF">ecg_flt</span> = <span style="color: #DCDDFF">ecg_flt</span> / <span style="color: #DCDDFF">max</span>(<span style="color: #DCDDFF">abs</span>(<span style="color: #DCDDFF">ecg_flt</span>))
        <span style="color: #DCDDFF">ecg_flt</span> = <span style="color: #DCDDFF">ecg_flt</span>**<span style="color: #00EBAA; font-style: italic">2</span>
</pre></div>
integration<div class="highlight"><pre style="line-height: 125%"><span></span>        <span style="color: #DCDDFF">N</span> = <span style="color: #DCDDFF">round</span>(<span style="color: #00EBAA; font-style: italic">0.150</span> * <span style="color: #DCDDFF">Fs</span>)
        <span style="color: #6400EB; font-weight: bold">return</span> <span style="color: #00EBAA; font-style: italic">1</span> / <span style="color: #DCDDFF">N</span> * <span style="color: #DCDDFF">lfilter</span>(<span style="color: #DCDDFF">ones</span>(<span style="color: #DCDDFF">N</span>), <span style="color: #00EBAA; font-style: italic">1</span>, <span style="color: #DCDDFF">ecg_flt</span>)
</pre></div>
</div><br><img src="<class 'mlib.web.shadow.AutoHTMLImage'>hep/master/docs/resources/figs/qrsalg/ECGLAB_QRS_Mod1.png" alt="an image" width="500"><br>De&nbsp;Carvalho, J.&nbsp;L., Da&nbsp;Rocha, A.&nbsp;F., de&nbsp;Oliveira&nbsp;Nascimento, F.&nbsp;A., Neto, J.&nbsp;S., &amp; Junqueira, L.&nbsp;F. (2002).
Development of a matlab software for analysis of heart rate variability.
<em>6th International Conference on Signal Processing, 2002.</em><br><img src="<class 'mlib.web.shadow.AutoHTMLImage'>hep/master/docs/resources/figs/qrsalg/ECGLAB_QRS_Mod2.png" alt="an image" width="500"><br><br><br><a href="../index.html">Back to Index</a><br></body></html>